{"version":3,"sources":["fetch.js"],"names":["apiUrl","guitars","document","querySelector","guitar","registros","comprar","opciones","style","currency","minimumFractionDigits","articulosCarrito","addEventListener","JSON","parse","localStorage","getItem","carritoLleno","carritoVacio","length","classList","remove","add","carritoHTML","obtenerGuitarras","url","window","location","search","params","URLSearchParams","get","href","obtenerGuitarra","textContent","Math","floor","random","confirm","print","clear","async","response","fetch","ok","Error","json","forEach","e","div","createElement","className","innerHTML","name","descript","price","toLocaleString","appendChild","error","console","model","find","undefined","id","agregarCarrito","amount","parseInt","value","info","total","some","carrito","guitarra","map","sincronizarStorage","alert","row","eliminarGuitarra","log","carritoFiltrados","filter","setItem","stringify"],"mappings":"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","file":"bundle.js","sourcesContent":["const apiUrl = '/api/guitars.json';\r\nconst guitars = document.querySelector('#guitars');\r\nconst guitar = document.querySelector('#guitar');\r\nconst registros = document.querySelector('#registros');\r\nconst comprar = document.querySelector('#comprar');\r\nconst opciones = {\r\n    style: \"currency\",\r\n    currency: \"MXN\",\r\n    minimumFractionDigits: 0,\r\n}\r\n\r\nlet articulosCarrito = [];\r\n\r\n/* Muestra los cursos de localStorage */\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    articulosCarrito = JSON.parse(localStorage.getItem('carrito') || []);\r\n    if (registros) {\r\n        const carritoLleno = document.querySelector('#carritoLleno');\r\n        const carritoVacio = document.querySelector('#carritoVacio');\r\n        if (articulosCarrito.length !== 0) {\r\n            carritoLleno.classList.remove('d-none');\r\n            carritoVacio.classList.add('d-none');\r\n            carritoHTML(articulosCarrito);\r\n        }\r\n    }\r\n});\r\n\r\n/* Llama a la función para obtener las guitarras */\r\nif (guitars) {\r\n    obtenerGuitarras();\r\n}\r\n\r\n/* Llama a la función para obtener la guitarra */\r\nif (guitar) {\r\n    const url = window.location.search;\r\n    const params = new URLSearchParams(url);\r\n\r\n    /* Validar que el parametro no sea nulo */\r\n    if (params.get(\"model\") == '') {\r\n        window.location.href = '/'\r\n    }\r\n    obtenerGuitarra(params.get(\"model\"));\r\n}\r\n\r\nif (comprar) {\r\n    /* Generar folio */\r\n    let folio = document.querySelector('#folio').textContent = Math.floor(Math.random() * 9000) + 1000;\r\n\r\n    comprar.addEventListener('click', () => {\r\n        if (confirm('¿Deseas finalizar la compra?')) {\r\n            window.print();\r\n            localStorage.clear();\r\n            window.location.href = '/guitarras.html'\r\n        }\r\n    });\r\n}\r\n\r\nasync function obtenerGuitarras() {\r\n\r\n    try {\r\n        const response = await fetch(apiUrl);\r\n\r\n        if (!response.ok) {\r\n            throw new Error('Error al consultar API');\r\n        }\r\n\r\n        const data = await response.json();\r\n        data.forEach(e => {\r\n            const div = document.createElement('DIV');\r\n            div.className = 'col-md-6 col-lg-4 my-4 row align-items-center';\r\n            div.innerHTML = `\r\n                <div class=\"col-4\">\r\n                    <picture>\r\n                        <source srcset=\"/build/img/${e.name}.avif\" type=\"image/avif\">\r\n                        <source srcset=\"/build/img/${e.name}.webp\" type=\"image/webp\">\r\n                        <img loading=\"lazy\" src=\"/build/img/${e.name}.jpg\" alt=\"Imagen ${e.name}\" class=\"img-fluid\" width=\"400\" height=\"600\">\r\n                    </picture>\r\n                </div>\r\n                <div class=\"col-8 d-flex h-100 flex-column justify-content-between\">\r\n                    <h3 class=\"text-black fs-4 fw-bold\">${e.name}</h3>\r\n                    <p>${e.descript}</p>\r\n                        <p class=\"fw-black text-primary fs-3\">${e.price.toLocaleString(\"es-MX\", opciones)}</p>\r\n                        <a href=\"guitarra.html?model=${e.name}\" class=\"btn btn-dark d-block py-1 text-uppercase fw-black\">Ver Producto</a>\r\n                </div>\r\n            `;\r\n            guitars.appendChild(div);\r\n        });\r\n    } catch (error) {\r\n        console.error('Error al obtener datos de la API:', error);\r\n    }\r\n}\r\n\r\nasync function obtenerGuitarra(name) {\r\n\r\n    try {\r\n        const response = await fetch(apiUrl);\r\n\r\n        if (!response.ok) {\r\n            throw new Error('Error al consultar API');\r\n        }\r\n\r\n        const data = await response.json();\r\n        const model = data.find(guitar => guitar.name === name);\r\n        /* Validar que coincida la busqueda */\r\n        if (model === undefined) {\r\n            window.location.href = '/'\r\n        }\r\n\r\n        const div = document.createElement('DIV');\r\n        div.className = 'row flex-column flex-md-row';\r\n        div.innerHTML = `\r\n        <div class=\"col-md-4 guitarra-imagen\">\r\n            <picture>\r\n                <source srcset=\"/build/img/${model.name}.avif\" type=\"image/avif\">\r\n                <source srcset=\"/build/img/${model.name}.webp\" type=\"image/webp\">\r\n                <img loading=\"lazy\" src=\"/build/img/${model.name}.jpg\" alt=\"Imagen ${model.name}\" class=\"img-fluid\" width=\"400\" height=\"600\">\r\n            </picture>\r\n        </div>\r\n        <div class=\"col-md-8 d-flex flex-column justify-content-center\">\r\n            <h3 class=\"text-dark\">${model.name}</h3>\r\n            <p>${model.descript}</p>\r\n            <p class=\"text-primary fs-1 fw-black\">${model.price.toLocaleString('es-MX', opciones)}</p>\r\n            <form>\r\n                <label for=\"cantidad\" class=\"form-label\">Cantidad</label>\r\n                <select name=\"cantidad\" id=\"cantidad\" class=\"form-select rounded-pill ps-2 border border-dark border-1\" required>\r\n                    <option value=\"1\">1</option>\r\n                    <option value=\"2\">2</option>\r\n                    <option value=\"3\">3</option>\r\n                    <option value=\"4\">4</option>\r\n                    <option value=\"5\">5</option>\r\n                </select>\r\n                <button type=\"button\" onclick=\"agregarCarrito(${model.id}, '${model.name}', ${model.price})\" class=\"btn btn-primary w-100 py-1 text-white text-uppercase mt-3\">Agregar al Carrito</button>\r\n            </form>\r\n        </div>                \r\n        `;\r\n        guitar.appendChild(div);\r\n    } catch (error) {\r\n        console.error('Error al obtener datos de la API:', error);\r\n    }\r\n}\r\n\r\nfunction agregarCarrito(id, name, price) {\r\n    const amount = parseInt(document.querySelector('select').value);\r\n    /* Crear un objeto con el contenido del carrito */\r\n    const info = { id, name, price, amount, total: amount * price }\r\n\r\n    /* Revisa si un elemento ya existe en el carrito */\r\n    const existe = articulosCarrito.some(carrito => carrito.id === info.id);\r\n    if (existe) {\r\n        /* Actualizamos la cantidad */\r\n        const guitarra = articulosCarrito.map(carrito => {\r\n            if (carrito.id === info.id) {\r\n                carrito.amount = carrito.amount + amount;\r\n                carrito.total = carrito.total + info.total;\r\n                return carrito; /* objeto actualizado */\r\n            } else {\r\n                return carrito; /* objeto que no estan duplicados */\r\n            }\r\n        });\r\n        articulosCarrito = [...guitarra];\r\n    } else {\r\n        /* Agregar elementos al arreglo de carrito */\r\n        articulosCarrito = [...articulosCarrito, info];\r\n    }\r\n\r\n    sincronizarStorage();\r\n    alert(`La guitarra ${name} se agrega al carrito exitosamente`);\r\n    window.location.href = '/carrito.html'\r\n}\r\n\r\nfunction carritoHTML(carrito) {\r\n    /* Recorrer el carrito y genera el HTML */\r\n    carrito.forEach(info => {\r\n        const { name, price, amount, total, id } = info;\r\n        const row = document.createElement('tr');\r\n        row.innerHTML = `\r\n            <td class=\"min-w-10\">\r\n                <picture>\r\n                    <source srcset=\"/build/img/${name}.avif\" type=\"image/avif\">\r\n                    <source srcset=\"/build/img/${name}.webp\" type=\"image/webp\">\r\n                    <img loading=\"lazy\" src=\"/build/img/${name}.jpg\" alt=\"Imagen ${name}\" class=\"img-fluid\" width=\"64\" height=\"128\">\r\n                </picture>\r\n            </td>\r\n            <td> \r\n                ${name}\r\n            </td>\r\n            <td>\r\n                ${parseInt(price).toLocaleString('es-MX', opciones)}\r\n            </td>\r\n            <td>\r\n                ${amount}\r\n            </td>\r\n            <td>\r\n                ${total}\r\n            </td>\r\n            <td>\r\n                <button type=\"button\" class=\"borrar-info imprimir-ocultar\" onclick=\"eliminarGuitarra(${id}, '${name}')\">\r\n                    <img src=\"/build/img/x.svg\" alt=\"Borrar\" class=\"img-fluid\" width=\"32\" height=\"32\">\r\n                </button>\r\n            </td>\r\n        `;\r\n        /* Agregar el html en el tbody */\r\n        registros.appendChild(row);\r\n    });\r\n}\r\n\r\nfunction eliminarGuitarra(id, name) {\r\n    const carrito = articulosCarrito.map(info => {\r\n        if (info.id === id) {\r\n            if (info.amount !== 0) {\r\n                info.amount--;\r\n            }\r\n        }\r\n        return info;\r\n    });\r\n    console.log(carrito);\r\n\r\n    const carritoFiltrados = carrito.filter(info => info.amount !== 0);\r\n    articulosCarrito = [...carritoFiltrados];\r\n\r\n    sincronizarStorage();\r\n    alert(`La guitarra ${name} se ha borrado exitosamente`);\r\n    window.location.href = '/carrito.html'\r\n}\r\n\r\nfunction sincronizarStorage() {\r\n    localStorage.setItem('carrito', JSON.stringify(articulosCarrito));\r\n}\r\n\r\n"]}